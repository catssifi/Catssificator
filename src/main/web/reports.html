<!doctype html>
<html lang="en">
  <head>
  	<meta charset="utf-8">
    <title>Catssificator - contents management console</title>
    <link href="/static/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap styles -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link href="/static/lib/bootstrap/css/mainsite.css" rel="stylesheet">

    <!-- start: for the datatable -->
    <link href="/static/lib/bootstrap/css/jquery.dataTables.css" rel="stylesheet">
    <style type="text/css">
      td.details-control {
          background: url('/static/lib/bootstrap/img/details_open.png') no-repeat center center;
          cursor: pointer;
      }
      tr.shown td.details-control {
          background: url('/static/lib/bootstrap/img/details_close.png') no-repeat center center;
      }
    </style>
    <script src="//code.jquery.com/jquery-1.11.1.min.js" language="javascript" type="text/javascript"></script>
    <script src="/static/lib/bootstrap/js/jquery.dataTables.min.js" language="javascript" type="text/javascript"></script>
    <script>

      /* Formatting function for row details - modify as you need */
      function format(){
          return '<div><table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">'+
              '<tr>'+
                  '<td>Full Category Path:</td>'+
                  '<td></td>'+
              '</tr>'+
              '<tr>'+
                  '<td>Full Query:</td>'+
                  '<td></td>'+
              '</tr>'+
          '</table></div>';
      }

      $(document).ready(function() {
          var table=$('#example').dataTable( {
              "processing": true,
              "serverSide": true,
              
              "ajax": "/api/report_past_queries"
              , 
              "columns": [
                  {
                      "className":      'details-control',
                      "orderable":      false,
                      "data":           null,
                      "defaultContent": ''
                  },
                  
                  { "data": "query" },
                  { "data": "from_who" },
                  { "data": "categories" },
                  { "data": "create_date" }
              ]
          } );
           // Add event listener for opening and closing details
          $('#example tbody').on('click', 'td.details-control', function () {
              var tr = $(this).closest('tr');
              if (tr.next().has('div').length>0) {
                tr.next().remove()
              } else {
                tr.after('<tr><td colspan=5>'+format()+'</td></tr>')
              }
              /*
              var row = table.row( tr );
       
              if ( row.child.isShown() ) {
                  // This row is already open - close it
                  row.child.hide();
                  tr.removeClass('shown');
              }
              else {
                  // Open this row
                  row.child( format(row.data()) ).show();
                  tr.addClass('shown');
              }
              */
          } );
      } );
    </script>
    <!-- end: for the datatable -->

  </head>
  <body>
  <div id="divMainFrame" class="divMainFrame">
  <p align="left">
  <img src="/static/lib/bootstrap/img/category-classificator.png">
  </p>
  
<ul class="nav nav-tabs">
        <li><a href="/">Home</a></li>
        <li><a href="upload.html">Upload Query</a></li>
        <li class="active"><a href="reports.html">Reports</a></li>
        <li ><a href="about.html">About</a></li>
    </ul>

<blockquote><h3>Total number of submissions in the past day: 0</h3> </blockquote>
  
  <table class="table table-striped table-bordered">
    <thead>
    <tr>
    <th>The submitted queries in the past</th>
    </tr>
  </thead>
  <tbody>
  <tr>
    <td>

<table id="example" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th></th>
                <th>Query</th>
                <th>Source IP</th>
                <th>Category</th>
                <th>Date</th>
            </tr>
        </thead>
 
        <tfoot>
            <tr>
                <th></th>
                <th>Query</th>
                <th>Source IP</th>
                <th>Category</th>
                <th>Date</th>
            </tr>
        </tfoot>
    </table>

    </td>
    </tr>

    <!--
    <tr>
    <th></th>
    </tr>
    <tr>
    <td>  
    </td>
    </tr>
    !-->

  </tr>
  </tbody>
  </table>


         </div> 
                    
        

  </body>
</html>